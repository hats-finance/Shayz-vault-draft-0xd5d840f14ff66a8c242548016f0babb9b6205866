import { SessionKey } from "openpgp";

export enum VulnerabilityStep {
  project,
  contact,
  description,
  terms,
  submission,
}

export interface ISubmissionProjectData {
  verified: boolean;
  projectName: string;
  projectId: string;
  contractAddress: string;
}

export interface ISubmissionContactData {
  beneficiary: string;
  communicationChannel: string;
  communicationChannelType: "discord" | "email" | "telegram";
  githubUsername?: string;
  verified: boolean;
}

export interface ISubmissionDescriptionData {
  verified: boolean;
  title: string;
  description: string;
  encryptedData: string;
  sessionKey: SessionKey;
}

export interface ISubmissionTermsData {
  verified: boolean;
}

export interface ISubmissionResultData {
  verified: boolean;
  txStatus: SubmissionOpStatus | undefined;
  botStatus: SubmissionOpStatus | undefined;
  transactionHash: string;
  chainId: number;
}

export interface IVulnerabilityData {
  version: string;
  project?: ISubmissionProjectData;
  contact?: ISubmissionContactData;
  description?: ISubmissionDescriptionData;
  terms?: ISubmissionTermsData;
  submission?: ISubmissionResultData;
}

export enum SubmissionOpStatus {
  Pending,
  Success,
  Fail,
}
